---
title: "First javascript using github pages"
date: 2025-10-07
---

<div id="radiofrance-api">
  <label>RadioFrance API Key (this will be used client-side):</label>
  <input id="apiKey_post" placeholder="Put your API key here (get it at https://openapi.radiofrance.fr)" style="width:100%" />
  <p style="color:#a00;font-size:90%;">Warning: API keys used in client-side JavaScript are public. Do not publish a real key in a public repo.</p>
  <br/>
  <label>Query</label>
  <textarea id="query_post" style="width:100%;height:120px">{ brands { id title } }</textarea>
  <p>
    <button id="run_post">Run query</button>
  </p>
  <pre id="out_post">(no result yet)</pre>

  <p>
    <!-- Dropdown removed: users can type a Brand ID into the Brand ID input instead -->
    <!-- If you want a dropdown later, re-add a <select id="brands_select"> element and the JS below -->
  </p>

  <hr />
  <h3>WebRadios for a brand</h3>
  <label>Brand ID (e.g. FIP):</label>
  <input id="brand_post" value="FIP" style="width:100%" />
  <p>
    <button id="run_webradios">Fetch webRadios</button>
  </p>
  <pre id="out_webradios">(no result yet)</pre>

  <hr />
  <h3>Track info for a webRadio</h3>
  <label>webRadio ID (e.g. FIP):</label>
  <input id="radio_post" placeholder="Enter webRadio ID" style="width:100%" />
  <p>
    <button id="run_track">Fetch track info</button>
  </p>
  <pre id="out_track">(no result yet)</pre>
</div>

<script>
  (function(){
    // NOTE: This page now calls RadioFrance API directly from the browser using a user-supplied API key.
    // Security: keys used client-side are visible to anyone who inspects the page or network traffic. Use for testing only.
    const apiKey = () => document.getElementById('apiKey_post').value.trim();

    async function callRadioFrance(query) {
      const key = apiKey();
      if (!key) return alert('Enter your RadioFrance API key');
      const url = 'https://openapi.radiofrance.fr/v1/graphql';
      const res = await fetch(url, { method: 'POST', headers: {'Content-Type': 'application/json', 'x-token': key }, body: JSON.stringify({ query }) });
      const text = await res.text();
      try { return JSON.parse(text); } catch { return text; }
    }

    // Run ad-hoc queries (results shown below)
    const out = document.getElementById('out_post');
    document.getElementById('run_post').addEventListener('click', async () => {
      const query = document.getElementById('query_post').value;
      out.textContent = 'Loading...';
      try {
        const data = await callRadioFrance(query);
        out.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
      } catch (err) { out.textContent = 'Error: ' + err }
    });

    // webradios
    const outWeb = document.getElementById('out_webradios');
    document.getElementById('run_webradios').addEventListener('click', async () => {
      const brand = document.getElementById('brand_post').value.trim();
      if (!brand) return alert('Enter a brand ID');
      const query = `\n{\n  brand(id: ${brand}) {\n    id\n    title\n    localRadios { id title }\n    webRadios { id title }\n  }\n}\n`;
      outWeb.textContent = 'Loading...';
      try {
        const data = await callRadioFrance(query);
        outWeb.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
      } catch (err) { outWeb.textContent = 'Error: ' + err }
    });

    // track info
    const outTrack = document.getElementById('out_track');
    document.getElementById('run_track').addEventListener('click', async () => {
      const radio = document.getElementById('radio_post').value.trim();
      if (!radio) return alert('Enter a webRadio ID');
      const query = `\n{\n  live(station: ${radio}) {\n    song {\n      track {\n        id\n        title\n        albumTitle\n        label\n        mainArtists\n        authors\n        composers\n        performers\n        productionDate\n        discNumber\n        trackNumber\n      }\n    }\n  }\n}\n`;
      outTrack.textContent = 'Loading...';
      try {
        const data = await callRadioFrance(query);
        outTrack.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
      } catch (err) { outTrack.textContent = 'Error: ' + err }
    });
  })();
</script>