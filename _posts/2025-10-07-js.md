Title: "First javascript using github pages"
Date: 2025-01-07

In this post I translated a small Python script that talks to the Radio France GraphQL API into JavaScript. I provide two ways to use it:

- A local Node.js CLI that reads the API key from the environment (or a .env file).
- A Netlify serverless function that proxies requests so you can keep the API key in Netlify environment variables and call the function from client-side code (useful on GitHub Pages).

Files added

- `scripts/radiofrance_cli.js` — Node.js CLI translation of the original Python script.
- `netlify/functions/radiofrance.js` — Netlify serverless function which proxies GraphQL requests and uses the Netlify `API_KEY` env var.

Local usage (CLI)

1. Install Node.js (>=12) and in the site root run:

	npm install node-fetch@2 dotenv

2. Create a `.env` file in the repository root with the API key:

	API_KEY=814221c7-ddc3-4710-8c77-d19cf80f7002

3. Run the CLI:

	node scripts/radiofrance_cli.js

The script will print the GraphQL JSON responses and prompt for brand and webRadio IDs (same behavior as the original Python script).

Using Netlify functions (recommended for client-side GitHub Pages)

1. Deploy this site to Netlify (connect the GitHub repo).
2. In Netlify site settings -> Build & deploy -> Environment, add a variable `API_KEY` with the secret value.
3. The function is available at `/.netlify/functions/radiofrance` and accepts the same GraphQL POST body as the upstream API. From client-side JS (GitHub Pages) you can call it like:

```js
fetch('/.netlify/functions/radiofrance', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ query: '{ brands { id title } }' })
}).then(r => r.json()).then(console.log)
```

Notes and security

- Keep the API key out of the repository. Use Netlify environment variables or a local `.env` file that is ignored by Git.
- The Netlify function simply proxies the request and forwards the `x-token` header using the `API_KEY` env var. You may want to add request validation or rate-limiting depending on usage.

If you want, I can also add a small client-side example page to call the function and display results on the GitHub Pages site.