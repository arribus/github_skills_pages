---
title: "First javascript using github pages"
date: 2025-10-07
---
title: "First javascript using github pages"
date: 2025-10-07
layout: post
---
<div id="radio-demo">
  <label>Netlify function URL:</label>
  <input id="fnUrl_post" value="https://harmonious-banoffee-8d5c15.netlify.app/.netlify/functions/radiofrance" style="width:100%" />
  <br/><br/>
  <label>Query</label>
  <textarea id="query_post" style="width:100%;height:120px">{ brands { id title } }</textarea>
  <p>
    <button id="run_post">Run query</button>
  </p>
  <pre id="out_post">(no result yet)</pre>

  <p>
    <label>Or select a brand:</label>
    <select id="brands_select" style="width:100%"><option value="">(none)</option></select>
  </p>

  <hr />
  <h3>WebRadios for a brand</h3>
  <label>Brand ID (e.g. FIP):</label>
  <input id="brand_post" value="FIP" style="width:100%" />
  <p>
    <button id="run_webradios">Fetch webRadios</button>
  </p>
  <pre id="out_webradios">(no result yet)</pre>

  <hr />
  <h3>Track info for a webRadio</h3>
  <label>webRadio ID (e.g. FIP):</label>
  <input id="radio_post" placeholder="Enter webRadio ID" style="width:100%" />
  <p>
    <button id="run_track">Fetch track info</button>
  </p>
  <pre id="out_track">(no result yet)</pre>
</div>

<script>
  (function(){
    const fnUrl = () => document.getElementById('fnUrl_post').value.trim();

    async function callFn(query) {
      const url = fnUrl();
      if (!url) return alert('Enter your Netlify function URL');
      const res = await fetch(url, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ query }) });
      const text = await res.text();
      try { return JSON.parse(text); } catch { return text; }
    }

    // brands
    const out = document.getElementById('out_post');
    const brandsSelect = document.getElementById('brands_select');
    document.getElementById('run_post').addEventListener('click', async () => {
      const query = document.getElementById('query_post').value;
      out.textContent = 'Loading...';
      try {
        const data = await callFn(query);
        out.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
        // populate select if brands present
        if (data && data.data && Array.isArray(data.data.brands)) {
          brandsSelect.innerHTML = '<option value="">(none)</option>' + data.data.brands.map(b => `<option value="${b.id}">${b.title} (${b.id})</option>`).join('');
        }
      } catch (err) { out.textContent = 'Error: ' + err }
    });

    // when user picks a brand from the select, fill the brand input
    brandsSelect.addEventListener('change', () => {
      const val = brandsSelect.value;
      if (val) document.getElementById('brand_post').value = val;
    });

    // webradios
    const outWeb = document.getElementById('out_webradios');
    document.getElementById('run_webradios').addEventListener('click', async () => {
      const brand = document.getElementById('brand_post').value.trim();
      if (!brand) return alert('Enter a brand ID');
      const query = `\n{\n  brand(id: ${brand}) {\n    id\n    title\n    localRadios { id title }\n    webRadios { id title }\n  }\n}\n`;
      outWeb.textContent = 'Loading...';
      try {
        const data = await callFn(query);
        outWeb.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
      } catch (err) { outWeb.textContent = 'Error: ' + err }
    });

    // track info
    const outTrack = document.getElementById('out_track');
    document.getElementById('run_track').addEventListener('click', async () => {
      const radio = document.getElementById('radio_post').value.trim();
      if (!radio) return alert('Enter a webRadio ID');
      const query = `\n{\n  live(station: ${radio}) {\n    song {\n      track {\n        id\n        title\n        albumTitle\n        label\n        mainArtists\n        authors\n        composers\n        performers\n        productionDate\n        discNumber\n        trackNumber\n      }\n    }\n  }\n}\n`;
      outTrack.textContent = 'Loading...';
      try {
        const data = await callFn(query);
        outTrack.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
      } catch (err) { outTrack.textContent = 'Error: ' + err }
    });
  })();
</script>