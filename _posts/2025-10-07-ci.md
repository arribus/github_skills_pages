---
title: "Courrier International scraper (browser JS)"
date: 2025-10-07
layout: post
---

<div id="ci-scraper">
  <label>URL to fetch:</label>
  <input id="ci_url" value="https://www.courrierinternational.com/reveil" style="width:100%" />
  <p>
    <button id="ci_fetch">Fetch and parse</button>
  </p>

  <pre id="ci_out">(no result yet)</pre>
</div>

<script>
  (function(){
    const out = document.getElementById('ci_out');
    const urlInput = document.getElementById('ci_url');

    function log(...args) { out.textContent += args.join(' ') + '\n'; }
    function clear() { out.textContent = ''; }

    async function fetchHtml(url) {
      // Browsers may block cross-origin HTML fetches (CORS). If so, run a local proxy or server-side fetch.
      // For local testing you can run a small proxy (e.g., using http-server + a simple express proxy) or
      // deploy a lightweight serverless proxy (Vercel, Cloudflare Workers, etc.).
      const res = await fetch(url, { method: 'GET' });
      if (!res.ok) throw new Error('HTTP ' + res.status);
      return await res.text();
    }

    function parseHtml(html) {
      const parser = new DOMParser();
      return parser.parseFromString(html, 'text/html');
    }

    function extractArticleInfo(articleEl) {
      const index = articleEl.getAttribute('data-index') || 'No index available';
      const titleEl = articleEl.querySelector('h3.article-title') || articleEl.querySelector('h2');
      const title = titleEl ? titleEl.textContent.trim() : 'No title available';
      const ledeEl = articleEl.querySelector('p.article-lede');
      const lede = ledeEl ? ledeEl.textContent.trim() : 'No summary available';
      const captionEl = articleEl.querySelector('span.caption');
      const caption = captionEl ? captionEl.textContent.trim() : 'No caption available';
      return { index, title, lede, caption };
    }

    document.getElementById('ci_fetch').addEventListener('click', async () => {
      clear();
      const url = urlInput.value.trim();
      if (!url) { out.textContent = 'Enter a URL'; return; }

      log('üì° Fetching', url);
      try {
        const html = await fetchHtml(url);
        log('‚úÖ Fetched. Parsing HTML...');
        const doc = parseHtml(html);

        // Find article elements similar to the Python version
        const articles = Array.from(doc.querySelectorAll('article.article'));
        log('üîç Found', String(articles.length), 'articles');

        if (articles.length === 0) {
          log('‚ö†Ô∏è No articles found. The site structure may have changed or CORS prevented a full fetch.');
          // Attempt a broader search as a fallback
          const fallback = Array.from(doc.querySelectorAll('article')).slice(0,10);
          if (fallback.length) {
            log('Found', String(fallback.length), 'generic <article> elements ‚Äî showing first entries');
            fallback.forEach((a, i) => {
              const info = extractArticleInfo(a);
              log('\nüì∞ Article #' + (i+1) + ' (Index: ' + info.index + ')');
              log('Title: ' + info.title);
              log('Summary: ' + info.lede);
            });
          }
          return;
        }

        articles.forEach((a, i) => {
          const info = extractArticleInfo(a);
          log('\nüì∞ Article #' + (i+1) + ' (Index: ' + info.index + ')');
          log('Title: ' + info.title);
          log('Summary: ' + info.lede);
        });

        log('\n‚úÖ Successfully processed ' + articles.length + ' articles');
      } catch (err) {
        log('‚ùå Error: ' + err.message);
        log('\nNote: If you see a CORS error in the browser console, the remote site blocks cross-origin requests.');
        log('Use a server-side proxy or run this code from a server environment.');
      }
    });
  })();
</script>

<!--
Notes:
- Browsers often block cross-origin HTML fetches (CORS). If you get a CORS error, run the fetch via a server-side proxy.
- This repository previously included a serverless proxy example ‚Äî you can adapt a small server-side function to proxy requests to external sites if needed.
-->
