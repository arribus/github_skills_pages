<!DOCTYPE html>
<!--
  api_radiofrance.html
  Simple, beginner-friendly script page to call the project API for Radio France data.
  Keep changes minimal: update `api_radiofrance.js` for behavior and `api_radiofrance.css` for styles.
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Radio France API</title>
    <link rel="stylesheet" href="./api_radiofrance.css">
  </head>
  <body>
    <header>
      <h1>Radio France API</h1>
      <p class="lead"><em>Note:</em> When using the Render backend the API key is injected server-side. Avoid calling the Radio France API directly from the browser in production.</p>
    </header>

    <main>
      <section aria-labelledby="brands-heading">
        <h2 id="brands-heading">1. Fetch Brands</h2>
        <div class="field-row">
          <label for="apiKey">API Key</label>
          <input type="text" id="apiKey" name="apiKey" placeholder="Paste API key here" aria-describedby="key-help">
          <label for="keyMode">Send as</label>
          <select id="keyMode" name="keyMode">
            <option value="x-token" selected>x-token: &lt;key&gt; (Radio France default)</option>
            <option value="none">Don't send</option>
            <option value="bearer">Authorization: Bearer &lt;key&gt;</option>
            <option value="x-api-key">x-api-key: &lt;key&gt;</option>
          </select>
          <button type="button" data-action="fetchBrands">Get Brands</button>
        </div>
        <div id="key-help" class="sr-only">If your backend requires an API key, paste it here and choose how it should be sent.</div>
        <pre id="brandsOutput" aria-live="polite"></pre>
      </section>

      <section aria-labelledby="webradios-heading">
        <h2 id="webradios-heading">2. Fetch Web Radios</h2>
        <div class="field-row">
          <label for="brandId">Brand ID</label>
          <input type="text" id="brandId" name="brandId" placeholder="e.g. FIP" aria-describedby="brand-help">
          <button type="button" data-action="fetchWebRadios">Get Web Radios</button>
        </div>
        <div id="brand-help" class="sr-only">Enter a brand identifier such as FIP</div>
        <pre id="webradiosOutput" aria-live="polite"></pre>
      </section>

      <section aria-labelledby="track-heading">
        <h2 id="track-heading">3. Get Track Info</h2>
        <div class="field-row">
          <label for="stationId">Station ID</label>
          <input type="text" id="stationId" name="stationId" placeholder="e.g. FIP_ROCK">
          <button type="button" data-action="fetchTrackInfo">Get Track Info</button>
        </div>
        <pre id="trackOutput" aria-live="polite"></pre>
      </section>
    </main>

    <footer>
      <p class="lead" style="margin-top:1rem">Tip: If a request returns 404, check your backend routes and the <code>baseUrl</code> defined in <code>api_radiofrance.js</code>.</p>
    </footer>

    <script src="./api_radiofrance.js" defer></script>
    <script>
      // Wire buttons to functions exported by the module in a tiny, clear way.
      document.addEventListener('DOMContentLoaded', function () {
        const map = {
          fetchBrands: window.ApiRadioFrance && window.ApiRadioFrance.fetchBrands,
          fetchWebRadios: window.ApiRadioFrance && window.ApiRadioFrance.fetchWebRadios,
          fetchTrackInfo: window.ApiRadioFrance && window.ApiRadioFrance.fetchTrackInfo
        };
        document.querySelectorAll('button[data-action]').forEach(btn => {
          const name = btn.getAttribute('data-action');
          const fn = map[name];
          if (typeof fn === 'function') btn.addEventListener('click', fn);
        });
      });
    </script>
  </body>
</html>
